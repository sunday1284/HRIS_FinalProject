<%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%>
<%@ taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c" %>
<%@ taglib uri="http://java.sun.com/jsp/jstl/functions" prefix="fn" %>
<%@ taglib uri="http://java.sun.com/jsp/jstl/fmt" prefix="fmt" %>
<style>
thead th {
    text-align: center !important;
}

.modal-title {
    color: white !important;
    flex-grow: 1; /* ì œëª©ì´ ê°€ìš´ë° ì •ë ¬ë  ìˆ˜ ìˆë„ë¡ ì„¤ì • */
    text-align: center;
}
.modal-header .btn-close {
    filter: invert(1); /* ì•„ì´ì½˜ ìƒ‰ ë°˜ì „ (ê²€ì • â†’ í°ìƒ‰) */
    opacity: 1; /* ê¸°ë³¸ ë¶€íŠ¸ìŠ¤íŠ¸ë© ìŠ¤íƒ€ì¼ë³´ë‹¤ ë” ëšœë ·í•˜ê²Œ í‘œì‹œ */
}
.modal-body .list-group-item {
    border: none;  /* í…Œë‘ë¦¬ ì œê±° */
    padding: 10px 15px;
    background-color: #f9f9f9; /* ì—°í•œ ë°°ê²½ìƒ‰ */
    border-radius: 5px;
    margin-bottom: 5px;
}
.modal-body strong {
    display: inline-block;
    width: 120px; /* ë¼ë²¨ ë„ˆë¹„ í†µì¼ */
    font-weight: bold;
    color: #333;
}

.radio-label {
        margin-right: 20px; /* ë¼ë””ì˜¤ ë²„íŠ¼ ê°„ê²© ì¡°ì • */
}

.select-result {
    border: none;
    padding: 10px 15px;
    background-color: #f9f9f9;
    border-radius: 5px;
    margin-top: 10px;
    margin-bottom: 10px;
}
.select-result label {
    font-weight: bold;
    color: #333;
    display: inline-block;
    width: 120px;
}
.select-result strong {
    color: #0d6efd;
}
.select-result input[type="radio"] {
    margin-left: 10px;
    margin-right: 5px;
}

 /* ë¹„í™œì„±í™” ë¼ë””ì˜¤ë²„íŠ¼ ì¢€ ë” ëšœë ·í•˜ê²Œ */
 input[type="radio"]:disabled {
  appearance: none;
  width: 16px;
  height: 16px;
  border: 2px solid #555;  
  border-radius: 50%;
  background-color: #eee;  
  position: relative;
}
input[type="radio"]:disabled:checked::before {
  content: "";
  display: block;
  width: 8px;
  height: 8px;
  background-color: #555; 
  border-radius: 50%;
  position: absolute;
  top: 3px;
  left: 3px;
}
 
.modal.fade .modal-dialog {
    transition: transform 0.3s ease-out;
    transform: translateY(-10px);
}
.modal.show .modal-dialog {
    transform: translateY(0);
}

input[type="checkbox"].selectOne {
    transform: scale(1.5); /* 1.5ë°° í™•ëŒ€ */
    margin: 5px;
    cursor: pointer;
}

/* th ì •ë ¬ ìˆ¨ê¹€ */
th a.dataTable-sorter::after {
	display: none !important; 
}
th a.dataTable-sorter::before {
	display: none !important; 
}
th a.dataTable-sorter {
	pointer-events: none; 
}
/* 
th.excel a.dataTable-sorter::after {
	display: none !important; 
}
th.excel a.dataTable-sorter::before {
	display: none !important; 
}
th.excel a.dataTable-sorter {
	pointer-events: none; 
}
*/

/* === .dataTable-top css í…ŒìŠ¤íŠ¸ === */
/*
.dataTable-top {
	display: flex !important;
    justify-content: flex-end !important;
}
.dataTable-top div {
    margin-left: 30px;
}
.dataTable-dropdown label {
    margin-left: 5px !important;
}
  */
  
</style>

<!-- chart.js -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels"></script>

<!-- ë’¤ë¡œê°€ê¸°, Breadcrumb í†µì¼ -->
<div class="page-container container-fluid">
  <div class="d-flex justify-content-between align-items-center mb-2">
    <!-- ì¢Œì¸¡: ë²„íŠ¼ ê·¸ë£¹ -->
    <div>
      <button type="button" class="btn btn-outline-secondary" onclick="history.back();">
        <i class="fas fa-arrow-left"></i>
      </button>
    </div>
    <!-- ìš°ì¸¡: Breadcrumb -->
    <nav aria-label="breadcrumb">
      <ol class="breadcrumb mb-0">
        <li class="breadcrumb-item fw-bold text-primary"><a href="${pageContext.request.contextPath }/account/login/home"> ğŸ“Œ Main</a></li>
        <li class="breadcrumb-item">
          <a href="${pageContext.request.contextPath }/recruit/board/list">ì±„ìš©ê³µê³  ëª©ë¡</a>
        </li>
        <li class="breadcrumb-item active" aria-current="page">ë©´ì ‘ì ëª©ë¡</li>
      </ol>
    </nav>
  </div>
</div>

<section class="section">
	<div class="card">
		<div class="card-header">
			<h3>ë©´ì ‘ì ëª©ë¡</h3><hr>
			<h5 id="cardHeader" style="display: none;" >ë™ì ì œëª©</h5>
		</div>
		<div class="card-body">
<!-- 		ORDER BY RECRUIT_ID(ì§€ì›ê³µê³ ) DESC, INTERVIEW_DATE(ë©´ì ‘ë‚ ì§œ) DESC. -->
			<div style="text-dark; font-weight: bold;">âš ï¸í‰ê°€í•˜ê¸° ë²„íŠ¼ìœ¼ë¡œ ë©´ì ‘ì í‰ê°€ ê°€ëŠ¥ (í‰ê°€ ì €ì¥ ì‹œ ìë™ ë©”ì¼ ì „ì†¡)</div>
			<div style="text-dark; font-weight: bold;">âš ï¸í•©ê²©ì ì •ë³´ ì—‘ì…€ ë‹¤ìš´ë¡œë“œ ê°€ëŠ¥</div>
			<br><br>
			<!-- chart -->
			<div style="display: flex; justify-content: center; align-items: center; gap: 60px; width: 100%;">
			    <%-- 
			    <div style="width: 250px; height: 250px;">
			        <canvas id="interviewStatusChart"></canvas>
			    </div>
			    <div style="width: 250px; height: 250px;">
			        <canvas id="totalGenderChart"></canvas>
			    </div>
			    <div style="width: 250px; height: 250px;">
			        <canvas id="passedGenderChart"></canvas>
			    </div> --%>
			    
			    <div style="display: flex; justify-content: center; align-items: center; width: 31%; height: 300px;">
			        <canvas id="interviewStatusChart"></canvas>
			    </div>
			    <div style="display: flex; justify-content: center; align-items: center; width: 31%; height: 300px;">
			        <canvas id="totalGenderChart"></canvas>
			    </div>
			    <div style="display: flex; justify-content: center; align-items: center; width: 31%; height: 300px;">
			        <canvas id="passedGenderChart"></canvas>
			    </div>
			</div>
			<!-- ì„±ë³„ ë¹„ìœ¨ í™•ì¸ìš© -->
			<%-- <div>
				<c:forEach var="genderRatio" items="${totalGenderRatio}">
				    <p>ì´ ${genderRatio.APP_GENDER}: ${genderRatio.GENDER_COUNT}ëª…</p>
				</c:forEach>
				<c:forEach var="genderRatio" items="${passedGenderRatio}">
				    <p>í•©ê²© ${genderRatio.APP_GENDER}: ${genderRatio.GENDER_COUNT}ëª…</p>
				</c:forEach>
			</div> --%>
			<hr><br>
			<form id="excelDownloadForm" method="post" action="/recruit/interview/excelDownload">
				<!-- í…Œì´ë¸” ìƒë‹¨ ë²„íŠ¼ ì˜ì—­ ****************************************** -->
				<div class="d-flex justify-content-between align-items-center mb-2">
				    <div>
				        <button type="button" id="showCurrentBtn" class="btn btn-outline-primary">í˜„ì¬ ê³µê³ </button>
				        <button type="button" id="showPastBtn" class="btn btn-outline-secondary">ì§€ë‚œ ê³µê³ </button>
				    </div>
				    <div class="d-flex gap-2"><strong style="font-size:22px; color:green">Excel</strong>
				        <button type="submit" class="btn btn-outline-success ">ì„ íƒ ì¶œë ¥</button>
				        <button type="button" class="btn btn-outline-success " id="downloadAllBtn">ì „ì²´ ì¶œë ¥</button>
				    </div>
				</div>
				<!-- ë©´ì ‘ì í…Œì´ë¸” -->
				<table class="table table-striped text-center" id="table1">
					<thead class="text-center">
						<tr>
							<th>ì§€ì›ê³µê³ </th><!-- td:nth-child(1) ì‚¬ìš©ì¤‘ -->
							<th>ì§€ì›ì</th>
							<th>ë©´ì ‘ë‚ ì§œ</th>
							<th>ì§€ì›ì„œ</th>
							<th>í‰ê°€</th>
							<th>ê²°ê³¼</th>
							<th class="excel">Excel</th> 
						</tr>
					</thead>
					<tbody>
						<c:choose>
							<c:when test="${not empty interviewList }">
								<c:forEach items="${interviewList }" var="interview">
									<tr>
										<td class="text-start">
											<a href="#" data-bs-toggle="modal" data-bs-target="#recruitModal-${interview.recruitment.recruitId}">
										        ${interview.recruitment.recruitTitle}
										    </a>
										</td>
										<td>
											<%-- appId:${interview.appId}, --%>
											${interview.appName}
										</td>
										<td>${fn:substringBefore(interview.applicationStatus.interviewDate, ' ')}</td>
										<td>
											<button class="btn btn-outline-primary" data-bs-toggle="modal"
											 data-bs-target="#applicationModal-${interview.appId}" type="button">
												ì—´ëŒ
											</button>
										</td>
										<td>
	                                        <button class="btn ${interview.applicationStatus.currentStatus == 'ë©´ì ‘ì˜ˆì •' ? 'btn-success' : 'btn-secondary'} btn-sm"
											    data-bs-toggle="modal" data-bs-target="#evaluationModal-${interview.appId}"
											    data-status="${interview.applicationStatus.currentStatus}" type="button">
											    <!-- data-status ì†ì„± ì¶”ê°€ -->
											    ${interview.applicationStatus.currentStatus == 'ë©´ì ‘ì˜ˆì •' ? 'í‰ê°€í•˜ê¸°' : 'í‰ê°€ì™„ë£Œ'}
											</button>
										</td>
										<td id="status-${interview.appId}">
											${interview.applicationStatus.currentStatus }
										</td>
										<td>
											<!-- ì²´í¬ë°•ìŠ¤: í•©ê²©ì¸ ê²½ìš°ë§Œ í™œì„±í™” -->
											<input type="checkbox" name="appIds" value="${interview.appId}" class="selectOne"
												${interview.applicationStatus.currentStatus == 'í•©ê²©' ? '' : 'disabled'} />
										</td>
									</tr>
								</c:forEach>
							</c:when>
							<c:otherwise>
								<tr>
									<td colspan="7" class="text-center">ë©´ì ‘ì˜ˆì •ìê°€ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.</td>
								</tr>
							</c:otherwise>
						</c:choose>
					</tbody>
				</table>
			</form> 
		</div>
	</div>
</section>
<%-- ${interviewList } --%>
<%-- ëˆ„ì ì§€ì›ì ì„±ë³„ë¹„ìœ¨: ${totalGenderRatio } --%>
<%-- í•©ê²©ì ì„±ë³„ë¹„ìœ¨: ${passedGenderRatio } --%>
<!-- ì§€ì›ì„œ ìƒì„¸ ëª¨ë‹¬ì°½ -->
<c:forEach items="${interviewList}" var="interview">
    <div class="modal fade" id="applicationModal-${interview.appId}" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header bg-primary">
                    <h5 class="modal-title">ì§€ì›ì„œ ìƒì„¸ ì •ë³´</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                <div class="container">
                <div class="card">
                <div class="card-body">
                    <ul class="list-group">
					    <li class="list-group-item"><strong>ì´ë¦„</strong> ${interview.appName}</li>
					    <li class="list-group-item"><strong>ì„±ë³„</strong> ${interview.appGender}</li>
					    <li class="list-group-item"><strong>ìƒë…„ì›”ì¼</strong>
					        ${fn:substring(interview.appYeardate, 0, 4)}-${fn:substring(interview.appYeardate, 4, 6)}-${fn:substring(interview.appYeardate, 6, 8)}
					    </li>
					    <li class="list-group-item"><strong>ì´ë©”ì¼</strong> ${interview.appEmail}</li>
					    <li class="list-group-item"><strong>í•™ë ¥</strong> ${interview.appGrade}</li>
					    <li class="list-group-item"><strong>ê²½ë ¥</strong>
						    <span style="white-space: pre-line; display: block;">${interview.appCareer}</span>
						</li>
					    <li class="list-group-item"><strong>ìê¸°ì†Œê°œì„œ</strong>
						    <span style="white-space: pre-line; display: block;">${interview.appPl}</span>
						</li>
					</ul>
                </div>
                <div class="d-flex justify-content-center">
					<button type="button" class="btn btn-secondary " data-bs-dismiss="modal" id="closeRecruitModal">
						ë‹«ê¸°
					</button>
				</div>
                </div>
                </div>
                </div>
            </div>
        </div>
    </div>
</c:forEach>
<!-- ì±„ìš© ê³µê³  ìƒì„¸ ëª¨ë‹¬ì°½ -->
<c:forEach items="${interviewList}" var="interview">
    <div class="modal fade" id="recruitModal-${interview.recruitment.recruitId}" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header bg-primary">
                    <h5 class="modal-title">ì±„ìš© ê³µê³  ìƒì„¸ ì •ë³´</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                <div class="container">
                <div class="card">
                <div class="card-body">
                    <ul class="list-group">
					    <li class="list-group-item"><strong>ê³µê³ ì œëª©</strong> ${interview.recruitment.recruitTitle}</li>
					    <li class="list-group-item"><strong>ê·¼ë¬´ì§€</strong> ${interview.recruitment.recruitWorkplace}</li>
					    <li class="list-group-item"><strong>ê³ ìš©í˜•íƒœ</strong> ${interview.recruitment.recruitHiretype}</li>
					    <li class="list-group-item"><strong>ê¸‰ì—¬</strong> ì›” ${interview.recruitment.recruitSalary}ë§Œì›</li>
					    <li class="list-group-item"><strong>ëª¨ì§‘ë¶€ì„œ</strong> ${interview.recruitment.recruitPosition}</li>
					    <li class="list-group-item"><strong>ì—…ë¬´ë‚´ìš©</strong> ${interview.recruitment.recruitWorkdetail}</li>
					    <li class="list-group-item"><strong>ìš°ëŒ€ì‚¬í•­</strong> ${interview.recruitment.recruitPq}</li>
					    <li class="list-group-item"><strong>ëª¨ì§‘ê¸°ê°„</strong>
					        <fmt:formatDate value="${interview.recruitment.recruitStartdate}" pattern="yyyy-MM-dd" />
					        ~ <fmt:formatDate value="${interview.recruitment.recruitEnddate}" pattern="yyyy-MM-dd" />
					    </li>
					    <li class="list-group-item"><strong>ë¬¸ì˜ì²˜</strong> ${interview.recruitment.recruitContact}</li>
					    <li class="list-group-item"><strong>ëª¨ì§‘ì¸ì›</strong> ${interview.recruitment.recruitHirenum}ëª…</li>
					</ul>
                </div>
                <div class="d-flex justify-content-center">
					<button type="button" class="btn btn-secondary " data-bs-dismiss="modal" id="closeRecruitModal">
						ë‹«ê¸°
					</button>
				</div>
                </div>
                </div>
                </div>
            </div>
        </div>
    </div>
</c:forEach>
<!-- í‰ê°€ ëª¨ë‹¬ì°½ -->
<c:forEach items="${interviewList}" var="interview">
    <div class="modal fade" id="evaluationModal-${interview.appId}" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header bg-success text-white">
                    <h5 class="modal-title">ë©´ì ‘ í‰ê°€ - ${interview.appName}</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="evaluationForm-${interview.appId}">
<%-- App ID: ${interview.appId} --%>
<%-- Status ID: ${interview.applicationStatus.statusId} --%>
                        <ul class="list-group">
						    <li class="list-group-item">
							    <label class="form-label"><strong>ì „ë¬¸ì§€ì‹</strong></label>
							    <div>
							        <label><input type="radio" id="know-low-${interview.appId}" name="evalKnow" value="ë¯¸í¡"
					                    ${interview.applicationStatus.evalKnow == 'ë¯¸í¡' ? 'checked' : ''}> ë¯¸í¡</label>&nbsp;&nbsp;&nbsp;
					                <label><input type="radio" id="know-mid-${interview.appId}" name="evalKnow" value="ë³´í†µ"
					                    ${interview.applicationStatus.evalKnow == 'ë³´í†µ' ? 'checked' : ''}> ë³´í†µ</label>&nbsp;&nbsp;&nbsp;
					                <label><input type="radio" id="know-high-${interview.appId}" name="evalKnow" value="ìš°ìˆ˜"
					                    ${interview.applicationStatus.evalKnow == 'ìš°ìˆ˜' ? 'checked' : ''}> ìš°ìˆ˜</label>
							    </div>
							</li>
						    <li class="list-group-item">
							    <label class="form-label"><strong>ê¸°ìˆ ì—­ëŸ‰</strong></label>
							    <div>
							        <label><input type="radio" id="skill-low-${interview.appId}" name="evalSkill" value="ë¯¸í¡"
					                    ${interview.applicationStatus.evalSkill == 'ë¯¸í¡' ? 'checked' : ''}> ë¯¸í¡</label>&nbsp;&nbsp;&nbsp;
					                <label><input type="radio" id="skill-mid-${interview.appId}" name="evalSkill" value="ë³´í†µ"
					                    ${interview.applicationStatus.evalSkill == 'ë³´í†µ' ? 'checked' : ''}> ë³´í†µ</label>&nbsp;&nbsp;&nbsp;
					                <label><input type="radio" id="skill-high-${interview.appId}" name="evalSkill" value="ìš°ìˆ˜"
					                    ${interview.applicationStatus.evalSkill == 'ìš°ìˆ˜' ? 'checked' : ''}> ìš°ìˆ˜</label>
							    </div>
							</li>
						    <li class="list-group-item">
							    <label class="form-label"><strong>íƒœë„</strong></label>
							    <div>
							        <label><input type="radio" id="atti-low-${interview.appId}" name="evalAtti" value="ë¯¸í¡"
					                    ${interview.applicationStatus.evalAtti == 'ë¯¸í¡' ? 'checked' : ''}> ë¯¸í¡</label>&nbsp;&nbsp;&nbsp;
					                <label><input type="radio" id="atti-mid-${interview.appId}" name="evalAtti" value="ë³´í†µ"
					                    ${interview.applicationStatus.evalAtti == 'ë³´í†µ' ? 'checked' : ''}> ë³´í†µ</label>&nbsp;&nbsp;&nbsp;
					                <label><input type="radio" id="atti-high-${interview.appId}" name="evalAtti" value="ìš°ìˆ˜"
					                    ${interview.applicationStatus.evalAtti == 'ìš°ìˆ˜' ? 'checked' : ''}> ìš°ìˆ˜</label>
							    </div>
							</li>
						    <li class="list-group-item">
							    <label class="form-label"><strong>ì»¤ë®¤ë‹ˆì¼€ì´ì…˜</strong></label>
							    <div>
							        <label><input type="radio" id="commu-low-${interview.appId}" name="evalCommu" value="ë¯¸í¡"
					                    ${interview.applicationStatus.evalCommu == 'ë¯¸í¡' ? 'checked' : ''}> ë¯¸í¡</label>&nbsp;&nbsp;&nbsp;
					                <label><input type="radio" id="commu-mid-${interview.appId}" name="evalCommu" value="ë³´í†µ"
					                    ${interview.applicationStatus.evalCommu == 'ë³´í†µ' ? 'checked' : ''}> ë³´í†µ</label>&nbsp;&nbsp;&nbsp;
					                <label><input type="radio" id="commu-high-${interview.appId}" name="evalCommu" value="ìš°ìˆ˜"
					                    ${interview.applicationStatus.evalCommu == 'ìš°ìˆ˜' ? 'checked' : ''}> ìš°ìˆ˜</label>
							    </div>
							</li>
						    <li class="list-group-item">
							    <label class="form-label"><strong>ê²½í—˜</strong></label>
							    <div>
							        <label><input type="radio" id="experi-low-${interview.appId}" name="evalExperi" value="ë¯¸í¡"
					                    ${interview.applicationStatus.evalExperi == 'ë¯¸í¡' ? 'checked' : ''}> ë¯¸í¡</label>&nbsp;&nbsp;&nbsp;
					                <label><input type="radio" id="experi-mid-${interview.appId}" name="evalExperi" value="ë³´í†µ"
					                    ${interview.applicationStatus.evalExperi == 'ë³´í†µ' ? 'checked' : ''}> ë³´í†µ</label>&nbsp;&nbsp;&nbsp;
					                <label><input type="radio" id="experi-high-${interview.appId}" name="evalExperi" value="ìš°ìˆ˜"
					                    ${interview.applicationStatus.evalExperi == 'ìš°ìˆ˜' ? 'checked' : ''}> ìš°ìˆ˜</label>
							    </div>
							</li>
						</ul>
                        <div class="select-result">
						    <label class="form-label"><strong>ë©´ì ‘ ê²°ê³¼:</strong></label>
						    <div>
						    	<label><input type="radio" id="status-pass-${interview.appId}" name="currentStatus" value="í•©ê²©"
					                ${interview.applicationStatus.currentStatus == 'í•©ê²©' ? 'checked' : ''}> í•©ê²©</label>&nbsp;&nbsp;&nbsp;
					            <label><input type="radio" id="status-fail-${interview.appId}" name="currentStatus" value="ë¶ˆí•©ê²©"
					                ${interview.applicationStatus.currentStatus == 'ë¶ˆí•©ê²©' ? 'checked' : ''}> ë¶ˆí•©ê²©</label>
						    </div>
						</div>
                        <div class="d-flex justify-content-center">
	                        <button type="button" class="btn btn-primary ms-2 submit-eval-btn"
	                        	id="submitEvaluation-${interview.appId}"
	                        	data-app-id="${interview.appId}"
	                        	data-status-id="${interview.applicationStatus.statusId}"
							    ${interview.applicationStatus.currentStatus == 'í•©ê²©' || interview.applicationStatus.currentStatus == 'ë¶ˆí•©ê²©' ? 'disabled' : ''}>
							    <c:choose>
							        <c:when test="${interview.applicationStatus.currentStatus == 'í•©ê²©' || interview.applicationStatus.currentStatus == 'ë¶ˆí•©ê²©'}">
							            í‰ê°€ ì™„ë£Œ
							        </c:when>
							        <c:otherwise>
							            í‰ê°€ ì €ì¥
							        </c:otherwise>
							    </c:choose>
							</button>
	                        <button type="button" class="btn btn-secondary ms-2" data-bs-dismiss="modal" aria-label="Close">
	                            ë‹«ê¸°
	                        </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</c:forEach>

<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
<script>

document.addEventListener("DOMContentLoaded", function () {
	
	
//table1 ì…€ë ‰íŠ¸ë°•ìŠ¤ ì„¤ì •í•˜ê¸° ========================================
    const tableEl = document.querySelector('#table1');
    // ì´ˆê¸°í™”
    const dataTable = new simpleDatatables.DataTable(tableEl);

    // perPage ê°’ì„ ê°•ì œë¡œ 30ìœ¼ë¡œ ì„¤ì •
//     dataTable.options.perPage = 25;
    dataTable.options.perPage = 30;
    dataTable.page(1); // í˜ì´ì§€ ë‹¤ì‹œ ë¡œë”©

    // ì…€ë ‰íŠ¸ ë°•ìŠ¤ì— 30 optionì´ ì—†ìœ¼ë©´ ì¶”ê°€í•˜ê³  ì„ íƒ
    const selector = dataTable.wrapper.querySelector('.dataTable-selector');
    if (selector) {
    	// 30 optionì´ ì—†ì„ ê²½ìš° ë™ì ìœ¼ë¡œ ì¶”ê°€ ******
        if (![...selector.options].some(opt => opt.value === '30')) {
            const option = new Option('30', '30');
            selector.add(option);
        }
     	// 30ìœ¼ë¡œ ì„ íƒ ì„¤ì •
        selector.value = '30';
        selector.dispatchEvent(new Event('change'));
    }
    // ì…€ë ‰íŠ¸, í˜ì´ì§€ë„¤ì´ì…˜ ìŠ¤íƒ€ì¼ ê·¸ëŒ€ë¡œ ìœ ì§€
    function adaptPageDropdown() {
        const selector = dataTable.wrapper.querySelector(".dataTable-selector");
        selector.parentNode.parentNode.insertBefore(selector, selector.parentNode);
        selector.classList.add("form-select");
    }
    function adaptPagination() {
        const paginations = dataTable.wrapper.querySelectorAll("ul.dataTable-pagination-list");
        paginations.forEach(p => p.classList.add("pagination", "pagination-primary"));

        const paginationLis = dataTable.wrapper.querySelectorAll("ul.dataTable-pagination-list li");
        paginationLis.forEach(li => li.classList.add("page-item"));

        const paginationLinks = dataTable.wrapper.querySelectorAll("ul.dataTable-pagination-list li a");
        paginationLinks.forEach(link => link.classList.add("page-link"));
    }
    const refreshPagination = () => {
        adaptPagination();
    }
    dataTable.on("datatable.init", () => {
        adaptPageDropdown();
        refreshPagination();
    });
    dataTable.on("datatable.update", refreshPagination);
    dataTable.on("datatable.sort", refreshPagination);
    dataTable.on("datatable.page", adaptPagination);


	
// í•©ê²©ì ì •ë³´ ì—‘ì…€ ë‹¤ìš´ë¡œë“œ

	// ì„ íƒ ë‹¤ìš´ë¡œë“œ ì‹œ ì•„ë¬´ í•­ëª©ë„ ì„ íƒ ì•ˆ ë˜ì–´ ìˆì„ ê²½ìš° ê²½ê³ 
	document.getElementById("excelDownloadForm").addEventListener("submit", function (e) {
		const selected = document.querySelectorAll(".selectOne:checked");
		if (selected.length === 0) {
			alert("ì—‘ì…€ë¡œ ë‹¤ìš´ë¡œë“œí•  í•©ê²©ìë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.");
			e.preventDefault();
		}
	});
	
	// ì „ì²´ ë‹¤ìš´ë¡œë“œ downloadAllBtn
	document.getElementById("downloadAllBtn").addEventListener("click", function () {
        const confirmDownload = confirm("ì „ì²´ í•©ê²©ìì •ë³´ë¥¼ ë‹¤ìš´ë¡œë“œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?");
        if (confirmDownload) {
        	// ëª¨ë“  í–‰ ì„ íƒ
        	const visibleRows = document.querySelectorAll("#table1 tbody tr");
        	visibleRows.forEach(row => {
        		// display noneì´ ì•„ë‹Œ ê²½ìš° = í™”ë©´ì— ì¶œë ¥ëœ í–‰
        		if (row.style.display !== "none"){
        			// í˜„ì¬ í–‰(row)ì—ì„œ selectOneì´ë¼ëŠ” í´ë˜ìŠ¤ë¥¼ ê°€ì§€ê³  disabledì´ ì•„ë‹Œ input íƒœê·¸
        			// ==> í™œì„±í™”ëœ ì²´í¬ë°•ìŠ¤
        			const checkbox = row.querySelector("input.selectOne:not([disabled])");
        			if (checkbox){
        				checkbox.checked = true; // ì²´í¬ ì²˜ë¦¬
        			}
        		}
        	});
        	
            document.getElementById("excelDownloadForm").submit();
        }
    });
	
	// ê¸°ì¡´ ì²´í¬ë°•ìŠ¤ í•´ì œ í•¨ìˆ˜
	function resetAllCheckboxes() {
	    document.querySelectorAll("input.selectOne").forEach(cb => cb.checked = false);
	}
	
/////////////////////////////// Titleì— í˜„ì¬ ì—°ë„ ë°˜ê¸° ì¶œë ¥ (2025ë…„ ìƒë°˜ê¸° ë©´ì ‘ì í˜„í™©)   ///////////////////

	const today = new Date();
	const currentYear = today.getFullYear();
	const currentMonth = today.getMonth() + 1; // ì›”ì€ 0ë¶€í„° ì‹œì‘í•˜ë¯€ë¡œ +1 í•´ì¤˜ì•¼í•¨
	
	// í˜„ì¬ ì—°ë„ì™€ ë°˜ê¸°ë¥¼ ê³„ì‚°í•©ë‹ˆë‹¤.
	const currentHalf = currentMonth <= 6 ? "ìƒë°˜ê¸°" : "í•˜ë°˜ê¸°";
	
	// card-headerì˜ ì œëª©ì„ ë™ì ìœ¼ë¡œ ì„¤ì •í•©ë‹ˆë‹¤.
	const cardHeader = document.getElementById("cardHeader");
	cardHeader.innerText = currentYear + "ë…„ " + currentHalf + " ë©´ì ‘ì í˜„í™©";
	
	

/////////////////////////////// í˜„ì¬ê¸°ê°„(ì—°ë„&ë°˜ê¸°)ì— í•´ë‹¹í•˜ëŠ” ê³µê³  ëª©ë¡ë§Œ í•„í„°   //////////////////////////

	// ê¸°ë³¸ìœ¼ë¡œ ë³´ì´ê²Œ ì‹¤í–‰
	filterCurrentPeriodByRecruitTitle();
	
	// í˜„ì¬ê¸°ê°„ ê³µê³  ëª©ë¡
	function filterCurrentPeriodByRecruitTitle() {
	    // ì˜¤ëŠ˜ ë‚ ì§œë¥¼ ê¸°ì¤€ìœ¼ë¡œ í˜„ì¬ ì—°ë„ ë° ë°˜ê¸° ê²°ì •
	    const today = new Date();
	    const currentYear = today.getFullYear();
	    const currentHalf = today.getMonth() < 6 ? "ìƒë°˜ê¸°" : "í•˜ë°˜ê¸°";
	    
// 	    console.log("í˜„ì¬: " + currentYear + " " + currentHalf);
	
	    // í…Œì´ë¸”ì˜ ê° í–‰ì„ ìˆœíšŒí•˜ë©° ì±„ìš©ê³µê³  ì œëª©ì—ì„œ ì—°ë„ ë° ë°˜ê¸° ì¶”ì¶œ
	    const rows = document.querySelectorAll('#table1 tbody tr');
	    rows.forEach(row => {
	        const firstTd = row.querySelector('td:nth-child(1)');
	        if (firstTd) {
	            const anchor = firstTd.querySelector('a');
	            if (anchor) {
	                const titleText = anchor.innerText.trim();
	                // ì˜ˆì‹œ: "2025 ìƒë°˜ê¸° ë¬¼ë¥˜íŒ€ ì‹ ì…ì§ì› ì±„ìš©"
	                const match = titleText.match(/^(\d{4})\s*(ìƒë°˜ê¸°|í•˜ë°˜ê¸°)/);
	                if (match) {
	                    const titleYear = parseInt(match[1]);
	                    const titleHalf = match[2];
// 	                    console.log("ì¶”ì¶œëœ ì œëª© ì •ë³´:", titleYear, titleHalf);
	                    // í˜„ì¬ ì—°ë„ì™€ ë°˜ê¸°ì— í•´ë‹¹í•˜ë©´ í‘œì‹œ, ì•„ë‹ˆë©´ ìˆ¨ê¹€
	                    if (titleYear === currentYear && titleHalf === currentHalf) {
	                        row.style.display = '';
	                    } else {
	                        row.style.display = 'none';
	                    }
	                } else {
// 	                    console.error("ì±„ìš©ê³µê³  ì œëª© í˜•ì‹ì´ ì˜ˆìƒê³¼ ë‹¤ë¦„:", titleText);
	                }
	            }
	        }
	    });
	}

	//ì§€ë‚œ ê³µê³  ëª©ë¡
	function filterPastPeriodByRecruitTitle() {
	    // ì˜¤ëŠ˜ ë‚ ì§œë¥¼ ê¸°ì¤€ìœ¼ë¡œ í˜„ì¬ ì—°ë„ ë° ë°˜ê¸° ê²°ì •
	    const today = new Date();
	    const currentYear = today.getFullYear();
	    const currentHalf = today.getMonth() < 6 ? "ìƒë°˜ê¸°" : "í•˜ë°˜ê¸°";
	    
// 	    console.log("í˜„ì¬: " + currentYear + " " + currentHalf);
	
	    // í…Œì´ë¸”ì˜ ê° í–‰ì„ ìˆœíšŒí•˜ë©° ì±„ìš©ê³µê³  ì œëª©ì—ì„œ ì—°ë„ ë° ë°˜ê¸° ì¶”ì¶œ
	    const rows = document.querySelectorAll('#table1 tbody tr');
	    rows.forEach(row => {
	        const firstTd = row.querySelector('td:nth-child(1)');
	        if (firstTd) {
	            const anchor = firstTd.querySelector('a');
	            if (anchor) {
	                const titleText = anchor.innerText.trim();
	                // ì˜ˆì‹œ: "2025 ìƒë°˜ê¸° ë¬¼ë¥˜íŒ€ ì‹ ì…ì§ì› ì±„ìš©"
	                const match = titleText.match(/^(\d{4})\s*(ìƒë°˜ê¸°|í•˜ë°˜ê¸°)/);
	                if (match) {
	                    const titleYear = parseInt(match[1]);
	                    const titleHalf = match[2];
// 	                    console.log("ì¶”ì¶œëœ ì œëª© ì •ë³´:", titleYear, titleHalf);
	                    // í˜„ì¬ ì—°ë„ì™€ ë°˜ê¸°ì™€ ì¼ì¹˜í•˜ë©´ ìˆ¨ê¸°ê³ , ê·¸ ì™¸ëŠ” í‘œì‹œ
	                    if (titleYear === currentYear && titleHalf === currentHalf) {
	                        row.style.display = 'none';
	                    } else {
	                        row.style.display = '';
	                    }
	                } else {
// 	                    console.error("ì±„ìš©ê³µê³  ì œëª© í˜•ì‹ì´ ì˜ˆìƒê³¼ ë‹¤ë¦„:", titleText);
	                }
	            }
	        }
	    });
	}
	//ê¸°ê°„ ë²„íŠ¼
	document.getElementById("showCurrentBtn").addEventListener("click", () => {
		resetAllCheckboxes(); // ì²´í¬ë°•ìŠ¤ í•´ì œ í•¨ìˆ˜ ì¶”ê°€
		filterCurrentPeriodByRecruitTitle();
	});
	document.getElementById("showPastBtn").addEventListener("click", () => {
		resetAllCheckboxes(); // ì²´í¬ë°•ìŠ¤ í•´ì œ í•¨ìˆ˜ ì¶”ê°€
	    filterPastPeriodByRecruitTitle();
	});

	
	
/////////////////////////////// í‰ê°€ì™„ë£Œ ëª¨ë‹¬ ë¼ë””ì˜¤ë²„íŠ¼ ë¹„í™œì„±í™” ìŠ¤í¬ë¦½íŠ¸  //////////////////////////////////

	document.body.addEventListener("click", function(event) {
	    // í´ë¦­ëœ ìš”ì†Œê°€ ë°ì´í„° ì†ì„± data-bs-targetì´ '#evaluationModal'ë¡œ ì‹œì‘í•˜ëŠ” ë²„íŠ¼ì¸ì§€ í™•ì¸
	    if (event.target.matches("[data-bs-target^='#evaluationModal']")) {
	
	        let button = event.target;
	        let appId = button.getAttribute("data-bs-target").replace("#evaluationModal-", ""); // appId ì¶”ì¶œ
	        let status = button.getAttribute("data-status"); // ë©´ì ‘ ìƒíƒœ ê°€ì ¸ì˜¤ê¸°
// 			console.log("Status: " + status); // status = í•©ê²©/ë¶ˆí•©ê²©/ë©´ì ‘ì˜ˆì •
	
	        let modal = document.querySelector("#evaluationModal-" + appId);
	        if (!modal) return;
	
	        let radioButtons = modal.querySelectorAll("input[type='radio']");
	
	        if (status === "í•©ê²©" || status === "ë¶ˆí•©ê²©" || status === "í‰ê°€ì™„ë£Œ") {
	            radioButtons.forEach(radio => radio.disabled = true);
	        } else {
	            radioButtons.forEach(radio => radio.disabled = false);
	        }
	    }
	});



/////////////////////////////////////////// ì„±ë³„ ë¹„ìœ¨ íŒŒì´ì°¨íŠ¸ ìŠ¤í¬ë¦½íŠ¸   ///////////////////////////////////////////

	let passedGenderChart = null;

//ì´ ì§€ì›ì ì„±ë³„ íŒŒì´ì°¨íŠ¸
	//JSP ë°ì´í„°ë¥¼ JavaScript ë°°ì—´ë¡œ ë³€í™˜
	const totGenderLabels = [];
	const totGenderData = [];
	const backgroundColors = [];

	
	<c:forEach var="genderRatio" items="${totalGenderRatio}">
		totGenderLabels.push("${genderRatio.APP_GENDER}");		// ë¬¸ìì—´ "ë‚¨ì/ì—¬ì"ì‚¬ìš©
		totGenderData.push(${genderRatio.GENDER_COUNT});		// ìˆ«ì "" ì‚¬ìš©x

		// ì„±ë³„ì— ë”°ë¼ ìƒ‰ìƒ ì§€ì •
	    if ("${genderRatio.APP_GENDER}" === "ë‚¨ì") {
	        backgroundColors.push("#36A2EB"); // íŒŒë€ìƒ‰ (ë‚¨ì)
	    } else {
	        backgroundColors.push("#FF6384"); // ë¹¨ê°„ìƒ‰ (ì—¬ì)
	    }
	</c:forEach>
	 

	// ì´ ì§€ì›ì ìˆ˜ ê³„ì‚°
	const totalApplicants = totGenderData.reduce((sum, count) => sum + count, 0);

	const ctx1 = document.getElementById('totalGenderChart').getContext('2d');
	new Chart(ctx1, {
		type: 'pie',
		data: {
		    labels: totGenderLabels,
		    datasets: [{
		        label: 'ëˆ„ì  ì§€ì›ì ì„±ë³„ ë¹„ìœ¨',
		        data: totGenderData,
		        backgroundColor: backgroundColors,
		        hoverOffset: 4
		    }]
		},
		options: {
		    responsive: true,
		    plugins: {
		        legend: {
		            position: 'top',
		        },
		        title: {
		            display: true,
		            text: 'ëˆ„ì  ì§€ì›ì ì„±ë³„ ë¹„ìœ¨'
		        },
		        tooltip: {
	                callbacks: {
	                    label: function(tooltipItem) {
	                    	const total = totGenderData.reduce((a, b) => a + b, 0);
	                    	const value = tooltipItem.raw; // í•´ë‹¹ ì¡°ê°ì˜ ì§€ì›ì ìˆ˜
	                    	const percentage = ((value / total) * 100).toFixed(1); // ë°±ë¶„ìœ¨ ê³„ì‚°
// 	                        return percentage + "%"; // n% í˜•ì‹ìœ¼ë¡œ ì¶œë ¥
	                    	return `\${tooltipItem.label}: \${percentage}% (\${value}ëª…)`;
	                    }
	                }
	            },
	            datalabels: {
					formatter: (value, context) => {
						const total = context.chart.data.datasets[0].data.reduce((a, b) => a + b, 0);
						const percentage = ((value / total) * 100).toFixed(1);
						return percentage + '%';
					},
					color: '#fff',
					font: {
						weight: 'bold',
						size: 14
					}
				}
		    }
		},
		plugins: [ChartDataLabels]
	});
	
//////////////////////////////////////í•©ê²©ì íŒŒì´ì°¨íŠ¸ ë¹„ë™ê¸° ê°±ì‹  ìŠ¤í¬ë¦½íŠ¸////////////////////////////////////////

	// í•©ê²©ì ì„±ë³„ ë¹„ìœ¨ ì°¨íŠ¸ ê°±ì‹  í•¨ìˆ˜
		fetchPassedGenderRatio();
		async function fetchPassedGenderRatio() {
		    try {
		        const response = await axios.get('/recruit/interview/passedGenderRatio');
		        updatePassedGenderChart(response.data); // ì„œë²„ì—ì„œ ë°›ì€ ë°ì´í„°ë¥¼ ì°¨íŠ¸ ê°±ì‹ ì— ì‚¬ìš©
		    } catch (error) {
// 		        console.error("Error fetching passed gender ratio:", error);
		    }
		}

	// ì°¨íŠ¸ ê°±ì‹  í•¨ìˆ˜
		function updatePassedGenderChart(passedGenderRatio) {
		    const passGenderLabels = [];
		    const passGenderData = [];
		    const pbackgroundColors = [];
		
		    passedGenderRatio.forEach(genderRatio => {
		        passGenderLabels.push(genderRatio.APP_GENDER);
		        passGenderData.push(genderRatio.GENDER_COUNT);
		        
		        // ì„±ë³„ì— ë”°ë¼ ìƒ‰ìƒ ì§€ì •
		        if (genderRatio.APP_GENDER === "ë‚¨ì") {
		            pbackgroundColors.push("#36A2EB"); // íŒŒë€ìƒ‰ (ë‚¨ì)
		        } else {
		            pbackgroundColors.push("#FF6384"); // ë¹¨ê°„ìƒ‰ (ì—¬ì)
		        }
		    });
		
		    const passApplicants = passGenderData.reduce((sum, count) => sum + count, 0);
		    
		    const canvas = document.getElementById('passedGenderChart');
		    
		    // ê¸°ì¡´ ì°¨íŠ¸ê°€ ìˆìœ¼ë©´ ì œê±°
		    if (Chart.getChart(canvas)) {
		        Chart.getChart(canvas).destroy();
		    }
		    
		    // ìº”ë²„ìŠ¤ ì»¨í…ìŠ¤íŠ¸ ë‹¤ì‹œ ê°€ì ¸ì˜¤ê¸°
		    const ctx2 = canvas.getContext('2d');
		    
		 	// ìƒˆ ì°¨íŠ¸ ìƒì„±
		    passedGenderChart = new Chart(ctx2, {
		        type: 'pie',
		        data: {
		            labels: passGenderLabels,
		            datasets: [{
		                label: 'ëˆ„ì  í•©ê²©ì ì„±ë³„ ë¹„ìœ¨',
		                data: passGenderData,
		                backgroundColor: pbackgroundColors,
		                hoverOffset: 4
		            }]
		        },
		        options: {
		            responsive: true,
		            plugins: {
		                legend: {
		                    position: 'top',
		                },
		                title: {
		                    display: true,
		                    text: 'ëˆ„ì  í•©ê²©ì ì„±ë³„ ë¹„ìœ¨'
		                },
		                tooltip: {
		                    callbacks: {
		                        label: function(tooltipItem) {
		                            let value = tooltipItem.raw; // í•´ë‹¹ ì¡°ê°ì˜ í•©ê²©ì ìˆ˜
		                            let percentage = ((value / passApplicants) * 100).toFixed(1); // ë°±ë¶„ìœ¨ ê³„ì‚°
// 		                            return percentage + "%"; // n% í˜•ì‹ìœ¼ë¡œ ì¶œë ¥
		                            return `\${tooltipItem.label}: \${percentage}% (\${value}ëª…)`;
		                        }
		                    }
		                },
		                datalabels: {
		                    formatter: (value, context) => {
		                        const total = context.chart.data.datasets[0].data.reduce((a, b) => a + b, 0);
		                        const percentage = ((value / total) * 100).toFixed(1);
		                        return percentage + '%';
		                    },
		                    color: '#fff',
		                    font: {
		                        weight: 'bold',
		                        size: 14
		                    }
		                }
		            }
		        },
		        plugins: [ChartDataLabels]
		    });
		}
			 
//////////////////////////////////////// í˜„ì¬ê³µê³  ë©´ì ‘ í˜„í™© íŒŒì´ì°¨íŠ¸ /////////////////////////////////////

     fetchInterviewStatus();
     async function fetchInterviewStatus() {
    	    try {
    	        const today2 = new Date();
    	        const year = today2.getFullYear();
    	        const half = (today2.getMonth() < 6) ? 1 : 2; // 1~6ì›”: ìƒë°˜ê¸°, 7~12ì›”: í•˜ë°˜ê¸°

    	        const response = await axios.get('/recruit/interview/interviewStatusCount', {
    	            params: { year: year, half: half }
    	        });

    	        var interviewStatusCount = response.data;
    	        
    	        // ë©´ì ‘ ìƒíƒœê°€ 'í•©ê²©' ë˜ëŠ” 'ë¶ˆí•©ê²©'ì¸ ê²½ìš° 'ë©´ì ‘ì™„ë£Œ'ë¡œ ë³€ê²½í•˜ê³  í•©ì‚°
    	        let interviewCompletedCount = 0;
    	        interviewStatusCount.forEach(item => {
    	            if (item.CURRENT_STATUS === 'í•©ê²©' || item.CURRENT_STATUS === 'ë¶ˆí•©ê²©') {
    	                interviewCompletedCount += item.COUNT;
    	            }
    	        });

    	        var labels = ['í‰ê°€ì˜ˆì •', 'í‰ê°€ì™„ë£Œ'];
    	        var data = [
    	            interviewStatusCount.find(item => item.CURRENT_STATUS === 'ë©´ì ‘ì˜ˆì •')?.COUNT || 0,  // ë©´ì ‘ì˜ˆì •ì˜ ê°œìˆ˜
    	            interviewCompletedCount // í•©ê²© + ë¶ˆí•©ê²©ì„ í•©ì¹œ ë©´ì ‘ì™„ë£Œì˜ ê°œìˆ˜
    	        ];

    	        var ctx3 = document.getElementById("interviewStatusChart").getContext("2d");
    	        
    	        // ê¸°ì¡´ ì°¨íŠ¸ê°€ ìˆìœ¼ë©´ ì œê±°
    	        if (Chart.getChart(ctx3)) {
    	            Chart.getChart(ctx3).destroy();
    	        }

    	        // ìƒˆ ì°¨íŠ¸ ìƒì„±
    	        new Chart(ctx3, {
    	            type: 'pie',
    	            data: {
    	                labels: labels,
    	                datasets: [{
    	                    label: '',
    	                    data: data ,
    	                    backgroundColor: ['#28A745', '#808080'],
    	                    hoverOffset: 4
    	                }]
    	            },
    	            options: {
    	                responsive: true,
    	                plugins: {
    	                	tooltip: {
    	                        callbacks: {
    	                            label: function(context) {
    	                                var value = context.raw; // ë°ì´í„° ê°’
    	                                // ": 2ê±´"ê³¼ ê°™ì´ í‘œì‹œ
    	                                return ': ' + value + 'ê±´';
    	                            }
    	                        }
    	                    },
    	                    title: {
    	                        display: true,
    	                        text: year + 'ë…„ ' + (half === 1 ? 'ìƒë°˜ê¸°' : 'í•˜ë°˜ê¸°') + ' ë©´ì ‘ì í˜„í™©'
    	                    },
    	                    legend: {
    	                        position: 'top'
    	                    },
    	                    datalabels: {
    	                        formatter: (value) => `\${value}ê±´`,
    	                        color: '#fff',
    	                        font: {
    	                            weight: 'bold',
    	                            size: 14
    	                        }
    	                    }
    	                }
    	            },
    	            plugins: [ChartDataLabels] 
    	            
    	        });

    	    } catch (error) {
//     	        console.error('Error fetching interview status data:', error);
    	    }
    	}


////////////////////////////////////// í‰ê°€ ì €ì¥ ìŠ¤í¬ë¦½íŠ¸ ///////////////////////////////////////////////
	async function submitEvaluation(event) {
	    try {
	    	// í´ë¦­ëœ ë²„íŠ¼ì—ì„œ appId, statusId ê°€ì ¸ì˜¤ê¸°
	    	const button = event.target;
            const appId = button.dataset.appId;
            const statusId = button.dataset.statusId;
	    	
	    	// í˜„ì¬ ëª¨ë‹¬ ë‚´ì—ì„œë§Œ ë¼ë””ì˜¤ ë²„íŠ¼ ê°’ ì°¾ê¸°
	        const modal = document.querySelector("#evaluationModal-" + appId);
	        if (!modal) {
	            alert("ëª¨ë‹¬ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");
	            return;
	        }

	    	// ì„ íƒëœ ë¼ë””ì˜¤ ë²„íŠ¼ì˜ ê°’ ê°€ì ¸ì˜¤ê¸°(ì„ íƒí•˜ì§€ ì•Šìœ¼ë©´ null)
	        const getCheckedValue = (name) => {
	            return modal.querySelector("input[name='" + name + "']:checked")?.value || null;
	        };

	     	// í•„ìˆ˜ í‰ê°€ í•­ëª© ëª©ë¡
	        const requiredFields = ["evalKnow", "evalSkill", "evalAtti", "evalCommu", "evalExperi", "currentStatus"];

	        // ëª¨ë“  í•­ëª©ì´ ì„ íƒë˜ì—ˆëŠ”ì§€ í™•ì¸
	        for (let field of requiredFields) {
	            if (!getCheckedValue(field)) {
	                alert("ëª¨ë“  í•­ëª©ì„ ì„ íƒí•´ì•¼ ì €ì¥ ê°€ëŠ¥í•©ë‹ˆë‹¤.");
	                return; // ì €ì¥ ì¤‘ë‹¨
	            }
	        }

	    	// ì‚¬ìš©ìì—ê²Œ ì €ì¥ í™•ì¸ ë©”ì‹œì§€ í‘œì‹œ
	        const isConfirmed = confirm("ì €ì¥í•œ í‰ê°€ëŠ” ìˆ˜ì •í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ì €ì¥í•˜ì‹œê² ìŠµë‹ˆê¹Œ?");
	        if (!isConfirmed) {
	            return; // ì·¨ì†Œ ì‹œ í•¨ìˆ˜ ì¢…ë£Œ
	        }

	        // í‰ê°€ ë°ì´í„°
	        const evaluationData = {
	                appId: appId,
	                statusId: statusId,
	                evalKnow: getCheckedValue("evalKnow"),
	                evalSkill: getCheckedValue("evalSkill"),
	                evalAtti: getCheckedValue("evalAtti"),
	                evalCommu: getCheckedValue("evalCommu"),
	                evalExperi: getCheckedValue("evalExperi"),
	                currentStatus: getCheckedValue("currentStatus")
	            };
// 	        console.log("Evaluation Data: ", evaluationData);


	        // ì„œë²„ì— í‰ê°€ ë°ì´í„° ì „ì†¡
	        let response = await axios.post('/recruit/interview/update', evaluationData);
// 			console.log("Server Response: ", response.data);

	        if (response.data.success) {
// 				console.log("Update successful, updating UI...");

	            // ëª¨ë‹¬ ìš”ì†Œ ì°¾ê¸°
	            let modalElement = document.getElementById("evaluationModal-" + appId);
// 				console.log("Modal Element: ", modalElement);

	            // ê²°ê³¼ td ê°±ì‹ 
			    let statusElement = document.getElementById("status-" + appId);
// 				console.log("Status Element: ", statusElement)
			    if (statusElement) {
			        statusElement.innerText = evaluationData.currentStatus;
// 			        console.log("Status updated to: " + evaluationData.currentStatus);
			    } else {
// 			    	console.error("Status element not found for appId: " + appId);
	       		}

				// ì²´í¬ ë°•ìŠ¤ ê°±ì‹  ===========================================================================
				if (evaluationData.currentStatus === 'í•©ê²©') {
				    let checkbox = document.querySelector(`input[type="checkbox"][name="appIds"][value="\${appId}"]`);
				    if (checkbox) {
				    	checkbox.removeAttribute("disabled");
				    }
				}

				// í‰ê°€ ë²„íŠ¼ ê°±ì‹ 
				let evalButton = document.querySelector("#table1 button[data-bs-target='#evaluationModal-" + appId + "']");
				if (evalButton) {
				    evalButton.innerText = "í‰ê°€ì™„ë£Œ";
				    evalButton.classList.remove("btn-success");
				    evalButton.classList.add("btn-secondary");
				 	// data-status ì†ì„±ì„ ì‹¤ì œ í‰ê°€ ìƒíƒœë¡œ ì—…ë°ì´íŠ¸
			        evalButton.setAttribute("data-status", evaluationData.currentStatus);	
				} else {
// 				    console.error("Evaluation button not found for appId: " + appId);
				}

				// ì €ì¥ ë²„íŠ¼ ë¹„í™œì„±í™”
				button.innerText = "í‰ê°€ ì™„ë£Œ";
                button.disabled = true;

				// ë¼ë””ì˜¤ ë²„íŠ¼ ë¹„í™œì„±í™”
				let radioButtons = modal.querySelectorAll("input[type='radio']");
            	radioButtons.forEach(radio => radio.disabled = true);

	         	// í•©ê²©ì ì„±ë³„ ë¹„ìœ¨ ì°¨íŠ¸ ê°±ì‹ 
	            fetchPassedGenderRatio();
	         	
	         	// ë©´ì ‘ í˜„í™© ì°¨íŠ¸ ê°±ì‹ 
	         	fetchInterviewStatus();
	         	

	            alert("í‰ê°€ ì €ì¥ ë° ë©”ì¼ ë°œì†¡ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.");
	        } else {
	            alert("ì €ì¥ ì‹¤íŒ¨: " + response.data.message);
	        }

	    } catch (error) {
// 	        console.error("Error occurred: ", error);
	        alert("ì˜¤ë¥˜ ë°œìƒ");
	    }
	}
	
	// ë²„íŠ¼ì— ì´ë²¤íŠ¸ ë°”ì¸ë”©
	document.querySelectorAll(".submit-eval-btn").forEach(button => {
        button.addEventListener("click", submitEvaluation);
    });
	
	

});
</script>

