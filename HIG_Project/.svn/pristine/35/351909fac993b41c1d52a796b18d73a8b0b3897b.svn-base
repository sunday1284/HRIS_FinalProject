<!-- 
 * == ê°œì •ì´ë ¥(Modification Information) ==
 *   
 *   ìˆ˜ì •ì¼             ìˆ˜ì •ì           ìˆ˜ì •ë‚´ìš©
 *  ============    =============== =======================
 *  2025. 3. 19.      CHOI            ìµœì´ˆ ìƒì„±
 *
-->
<%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%>
<%@ taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c"%>
<%@ taglib uri="http://www.springframework.org/security/tags"
	prefix="security"%>

    <!-- ìŠ¤íƒ€ì¼ë§Œ ì¶”ê°€ -->
    <style>
        .dashboard-container {
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
        }
        .summary-stats {
            display: flex;
            flex-wrap: wrap;
            gap: 1rem;
            margin-bottom: 1rem;
        }
        .stat-card {
            flex: 1;
            min-width: 120px;
            padding: 1rem;
            border-radius: 0.5rem;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            text-align: center;
            background: #f8f9fa;
        }
        .stat-card .stat-title {
            font-size: 0.9rem;
            color: #6c757d;
            margin-bottom: 0.5rem;
        }
        .stat-card .stat-value .badge {
            font-size: 1.2rem;
            font-weight: bold;
        }
        .data-visualization {
            display: flex;
            gap: 1.5rem;
            margin-bottom: 1.5rem;
        }
        .chart-container {
            max-width: 600px;         /* ìµœëŒ€ í­ ì œí•œ */
            width: 100%;
            padding: 1rem;
            border-radius: 0.5rem;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            background: #fff;
        }
    	.top-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 20px;
            margin-bottom: 20px;
            background-color: transparent; 
            box-shadow: none;
            border: none;
        }
        /* ë‚˜ë¨¸ì§€ í…Œì´ë¸” ìŠ¤íƒ€ì¼ì€ ê¸°ì¡´ ê·¸ëŒ€ë¡œ ìœ ì§€ */
    </style>

	<script src="${pageContext.request.contextPath}/resources/js/approval/approverChartStatusCount.js"></script>
</head>
 <!-- ================= Quick Menu ================= -->
<div class="top-bar">
    <!-- ì¢Œì¸¡: ë²„íŠ¼ ê·¸ë£¹ -->
    <div>
      <button type="button" class="btn btn-outline-secondary" onclick="history.back();">
        <i class="fas fa-arrow-left"></i> 
      </button>
    </div>
    
    
    <!-- ìš°ì¸¡: Breadcrumb -->
    <nav aria-label="breadcrumb">
      <ol class="breadcrumb mb-0">
        <li class="breadcrumb-item fw-bold text-primary">ğŸ“Œ Quick Menu</li>
        <li class="breadcrumb-item"><a href="/approval/templateList">ë¬¸ì„œì‘ì„±</a></li>
        <li class="breadcrumb-item active" aria-current="page">ì œì¶œë¬¸ì„œ</li>
        <li class="breadcrumb-item"><a href="/approval/approverDrafts">ê²°ì¬í˜„í™©</a></li>
        
        <security:authorize access="hasAnyRole('HR_MANAGER', 'HR_ADMIN')">
        	<li class="breadcrumb-item"><a href="/approval/list">ê²°ì¬ì–‘ì‹</a></li>
        </security:authorize>
      </ol>
    </nav>

    
</div>
<section class="section">
    <div class="card">
        <div class="card-header d-flex justify-content-between align-items-center">
            <h2 class="mb-0">ì œì¶œë¬¸ì„œ</h2>
            <!-- í•„ìš”ì‹œ ë²„íŠ¼ ì¶”ê°€ -->
            <div>
		        <a class="btn btn-primary btn-sm" href="/approval/templateList">ë¬¸ì„œ ì‘ì„±</a>
		        <button class="btn btn-outline-secondary btn-sm" onclick="location.reload()">ìƒˆë¡œê³ ì¹¨</button>
		    </div>
        </div>

        <div class="card-body dashboard-container">
            <!-- 1) ìƒíƒœë³„ ìš”ì•½ íŒ¨ë„ (JSì—ì„œ data-statusë¡œ ì±„ì›Œì¤ë‹ˆë‹¤) -->
            <div class="summary-stats">
                <div class="stat-card">
                    <div class="stat-title">ëŒ€ê¸°</div>
                    <div class="stat-value">
                        <span class="badge bg-secondary" data-status="ëŒ€ê¸°">${APRSTATUS}</span>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-title">íšŒìˆ˜</div>
                    <div class="stat-value">
                        <span class="badge bg-info" data-status="íšŒìˆ˜">${APRSTATUS}</span>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-title">ì™„ë£Œ</div>
                    <div class="stat-value">
                        <span class="badge bg-success" data-status="ìŠ¹ì¸">${APRSTATUS}</span>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-title">ë°˜ë ¤</div>
                    <div class="stat-value">
                        <span class="badge bg-danger" data-status="ë°˜ë ¤">${APRSTATUS}</span>
                    </div>
                </div>
            </div>

            

            <!-- 3) ê¸°ì¡´ ë°ì´í„°í…Œì´ë¸” ì»¨í…Œì´ë„ˆ -->
            <div id="draftDocumentsContainer"
                 class="dataTable-wrapper dataTable-loading no-footer sortable searchable fixed-columns">
                <div class="dataTable-top"></div>
            </div>
        </div>
    </div>
    

    
</section>

<!-- ê¸°ì¡´ ìŠ¤í¬ë¦½íŠ¸ë“¤ ê·¸ëŒ€ë¡œ ìœ ì§€ -->
<script src="${pageContext.request.contextPath}/resources/js/approval/approvalProcess.js"></script>
<script src="${pageContext.request.contextPath}/assets/extensions/simple-datatables/umd/simple-datatables.js"></script>
<script src="${pageContext.request.contextPath}/resources/template/dist/assets/static/js/pages/simple-datatables.js"></script>


<script>
$(document).ready(function () {
    // 1) ì „ì²´ ë¬¸ì„œ ì¡°íšŒ
    fetchMyDraftDocument();


    // 2) ë¡œì»¬ìŠ¤í† ë¦¬ì§€ ë³µì›(ê¸°ì¡´ ì½”ë“œ)
    const savedStatus = localStorage.getItem("draftStatusFilterValue");
    if (savedStatus) {
        $("#draftStatusFilter").val(savedStatus);
        filterDraftDocuments(window.draftData);
        localStorage.removeItem("draftStatusFilterValue");
    }
    
 
    // 3) ìš”ì•½ ì¹´ë“œ í´ë¦­ ì‹œ í•„í„°ë§
    $('.stat-card .badge')
      .css('cursor', 'pointer')
      .on('click', function() {
        // APRSTATUS ê°’
        const aprStatus = $(this).data('status'); // 'ëŒ€ê¸°' | 'ìŠ¹ì¸' | 'ë°˜ë ¤'
        // APRSTATUS â†’ draftStatus ë§¤í•‘
        const mapping = {
          'ëŒ€ê¸°': 'ëŒ€ê¸°',
          'ì™„ë£Œ': 'ìŠ¹ì¸',  // ì—¬ê¸°ê°€ í•µì‹¬!
          'ë°˜ë ¤': 'ë°˜ë ¤'
        };
        const filterVal = mapping[aprStatus] || 'all';
		
        
        
        // select ê°’ ë™ê¸°í™”
        $('#draftStatusFilter').val(filterVal);
        // ì‹¤ì œ í•„í„°ë§ í˜¸ì¶œ
        filterDraftDocuments(window.draftData);
      });
});
</script>

